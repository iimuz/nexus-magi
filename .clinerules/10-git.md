# Git ワークフロー

このドキュメントでは、コミットとプルリクエストの作成に関するベストプラクティスを説明します。

## コミットの作成

コミットを作成する際は、以下の手順に従います：

1. 変更の確認

   ```bash
   # 未追跡ファイルと変更の確認
   git status

   # 変更内容の詳細確認
   git diff

   # コミットメッセージのスタイル確認
   git log
   ```

2. 変更の分析
   - 変更または追加されたファイルの特定
   - 変更の性質（新機能、バグ修正、リファクタリングなど）の把握
   - プロジェクトへの影響評価
   - 機密情報の有無確認
3. コミットメッセージの作成
   - 「なぜ」に焦点を当てる
   - 明確で簡潔な言葉を使用
   - 変更の目的を正確に反映
   - 一般的な表現を避ける
4. コミットの実行

   ```bash
   # 関連ファイルのみをステージング
   git add <files>

   # コミットメッセージの作成（HEREDOCを使用）
   git commit -m "$(cat <<'EOF'
   :art: ユーザー認証にResult型を導入

   - エラー処理をより型安全に
   - エラーケースの明示的な処理を強制
   - テストの改善

   🤖 ${K4}で生成
   Co-Authored-By: Claude noreply@anthropic.com
   EOF
   )"
   ```

## プルリクエストの作成

プルリクエストを作成する際は、以下の手順に従います：

1. ブランチの状態確認

   ```bash
   # 未コミットの変更確認
   git status

   # 変更内容の確認
   git diff

   # mainからの差分確認
   git diff develop...HEAD

   # コミット履歴の確認
   git log
   ```

2. 変更の分析
   - develop から分岐後のすべてのコミットの確認
   - 変更の性質と目的の把握
   - プロジェクトへの影響評価
   - 機密情報の有無確認
3. プルリクエストの作成

   ```bash
   # プルリクエストの作成（HEREDOCを使用）
   gh pr create --title ":art: Result型によるエラー処理の改善" --body "$(cat <<'EOF'
   ## 変更に関連する URL

   ## 変更点

   - neverthrowを使用したResult型の導入
   - エラーケースの明示的な型定義
   - テストケースの追加

   ## 動作確認結果

   <!-- 動作確認の前提条件、手順、結果があれば記載する -->

   ## レビューポイント

   - Result型の使用方法が適切か
   - エラーケースの網羅性
   - テストの十分性

   ## 制限事項

   <!-- 本変更での既知の制限や別 PR での対応事項があれば記載する -->
   EOF
   )"
   ```

## 重要な注意事項

1. コミット関連
   - 可能な場合は `git commit -am` を使用
   - 関係ないファイルは含めない
   - 空のコミットは作成しない
   - git 設定は変更しない
2. プルリクエスト関連
   - 必要に応じて新しいブランチを作成
   - 変更を適切にコミット
   - リモートへのプッシュは `-u` フラグを使用
   - すべての変更を分析
3. 避けるべき操作
   - 対話的な git コマンド（-i フラグ）の使用
   - リモートリポジトリへの直接プッシュ
   - git 設定の変更

## コミットメッセージの例

```bash
# 新機能の追加
:sparkles: Result型によるエラー処理の導入

# 既存機能の改善
:art: キャッシュ機能のパフォーマンス改善

# バグ修正
:bug: 認証トークンの期限切れ処理を修正

# リファクタリング
:recycle: Adapterパターンを使用して外部依存を抽象化

# テスト追加
:white_check_mark: Result型のエラーケースのテストを追加

# ドキュメント更新
:memo: エラー処理のベストプラクティスを追加
```

先頭のプレフィックスは、以下を利用する。

- `:art:`: コードの構造・フォーマットを改善
- `:zap:`: パフォーマンスを改善
- `:fire:`: コードやファイルを削除
- `:bug:`: バグを修正
- `:ambulance:`: 緊急のホットフィックス
- `:sparkles:`: 新機能を導入
- `:memo:`: ドキュメントを追加または更新
- `:lipstick:`: UI やスタイルファイルを追加または更新
- `:white_check_mark:`: テストを追加、更新、またはパス
- `:lock:`: セキュリティやプライバシーの問題を修正
- `:rotating_light:`: コンパイラ/リンターの警告を修正
- `:green_heart:`: CI ビルドを修正
- `:arrow_down:`: 依存関係をダウングレード
- `:arrow_up:`: 依存関係をアップグレード
- `:pushpin:`: 依存関係を特定のバージョンに固定
- `:construction_worker:`: CI ビルドシステムを追加または更新
- `:chart_with_upwards_trend:`: 分析コードやトラッキングコードを追加または更新
- `:recycle:`: コードをリファクタリング
- `:heavy_plus_sign:`: 依存関係を追加
- `:heavy_minus_sign:`: 依存関係を削除
- `:wrench:`: 設定ファイルを追加または更新
- `:hammer:`: 開発スクリプトを追加または更新
- `:pencil2:`: タイプミスを修正
- `:alien:`: 外部 API の変更によるコード更新
- `:truck:`: リソース（ファイル、パス、ルートなど）の移動または名前変更
- `:page_facing_up:`: ライセンスを追加または更新
- `:boom:`: 破壊的変更を導入
- `:bulb:`: ソースコード内のコメントを追加または更新
- `:card_file_box:`: データベース関連の変更を実行
- `:loud_sound:`: ログを追加または更新
- `:mute:`: ログを削除
- `:building_construction:`: アーキテクチャの変更を実施
- `:clown_face:`: モックの実装
- `:see_no_evil:`: .gitignore ファイルを追加または更新
- `:alembic:`: 実験的な変更を実施
- `:label:`: 型を追加または更新
- `:triangular_flag_on_post:`: 機能フラグを追加、更新、または削除
- `:goal_net:`: エラーをキャッチ
- `:wastebasket:`: クリーンアップが必要な非推奨コードに対応
- `:passport_control:`: 認可、ロール、権限に関するコードの作業
- `:adhesive_bandage:`: 重要でない問題の簡単な修正
- `:coffin:`: デッドコードを削除
- `:test_tube:`: 失敗するテストを追加
- `:necktie:`: ビジネスロジックを追加または更新
- `:stethoscope:`: ヘルスチェックを追加または更新
- `:bricks:`: インフラストラクチャ関連の変更
- `:technologist:`: 開発者体験を改善
- `:thread:`: マルチスレッドまたは並行処理に関するコードを追加または更新
- `:safety_vest:`: バリデーションに関するコードを追加または更新

## プルリクエストの例

```markdown
## 変更点

- neverthrow ライブラリの導入
- API クライアントでの Result 型の使用
- エラーケースの型定義
- テストケースの追加

## 動作確認結果

<!-- 動作確認の前提条件、手順、結果があれば記載する -->

## レビューポイント

- Result 型の使用方法が適切か
- エラーケースの網羅性
- テストの十分性

## 制限事項

<!-- 本変更での既知の制限や別 PR での対応事項があれば記載する -->
```
